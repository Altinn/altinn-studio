{
  "$schema": "https://altinncdn.no/toolkits/altinn-app-frontend/4/schemas/json/layout/layout.schema.v1.json",
  "data": {
    "hidden": [
      "not",
      ["commaContains", ["dataModel", "ChooseExtraPages"], "filtered-options"]
    ],
    "layout": [
      {
        "id": "filteredOptionsNavBar",
        "type": "NavigationBar"
      },
      {
        "id": "dislikes",
        "type": "Checkboxes",
        "textResourceBindings": {
          "title": "Hva liker du ikke?",
          "description": "Velg de matvarene du ikke liker, så slipper du kunne velge disse i oppskriften. Alle liker selvfølgelig druer og banan, så disse kan du ikke velge bort."
        },
        "dataModelBindings": {
          "simpleBinding": "FilteredOptions.Dislikes"
        },
        "sortOrder": "asc",
        "optionsId": "foods",
        "optionFilter": ["not", ["or",
          ["equals", ["value", "label"], "foods.grape"],
          ["equals", ["value", "value"], 5]
        ]]
      },
      {
        "id": "ingredients",
        "type": "RepeatingGroup",
        "textResourceBindings": {
          "title": "Ingredienser",
          "description": "I listen under kan du legge til ingredienser som skal brukes i oppskriften."
        },
        "dataModelBindings": {
          "group": "FilteredOptions.Ingredients"
        },
        "children": [
          "ingredientId",
          "ingredientType",
          "ingredientAmount"
        ],
        "edit": {
          "deleteButton": true,
          "mode": "onlyTable"
        },
        "maxCount": 9999
      },
      {
        "id": "ingredientId",
        "type": "Text",
        "textResourceBindings": {
          "title": "ID"
        },
        "value": ["dataModel", "FilteredOptions.Ingredients.Type"]
      },
      {
        "id": "ingredientType",
        "type": "Dropdown",
        "textResourceBindings": {
          "title": "Ingrediens"
        },
        "dataModelBindings": {
          "simpleBinding": "FilteredOptions.Ingredients.Type"
        },
        "optionsId": "foods",
        "optionFilter": ["and",
          // Always remove disliked foods
          ["not", ["commaContains", ["dataModel", "FilteredOptions.Dislikes"], ["value"]]],
          ["or",
            // Remove those that have been used elsewhere
            ["not", ["commaContains", ["dataModel", "FilteredOptions.UsedTypes"], ["value"]]],
            // But not if it's the currently chosen ingredient here
            ["equals", ["component", "ingredientType"], ["value"]]
          ]
        ],
        "sortOrder": "asc",
        "required": true
      },
      {
        "id": "ingredientAmount",
        "type": "Input",
        "textResourceBindings": {
          "title": "Antall"
        },
        "dataModelBindings": {
          "simpleBinding": "FilteredOptions.Ingredients.Amount"
        },
        "formatting": {
          "number": {
            "thousandSeparator": " ",
            "suffix": " stk",
            "allowNegative": false
          },
          "align": "right"
        },
        "required": true
      },
      {
        "id": "filteredOptionsNavigate",
        "type": "NavigationButtons",
        "textResourceBindings": {
          "back": "Tilbake",
          "next": "Neste"
        },
        "validateOnNext": {
          "page": "current",
          "show": ["All"]
        },
        "showBackButton": true
      }
    ]
  }
}

