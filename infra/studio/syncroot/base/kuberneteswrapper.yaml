apiVersion: source.toolkit.fluxcd.io/v1beta2
kind: OCIRepository
metadata:
  name: kuberneteswrapper
  namespace: default
spec:
  interval: 5m
  url: oci://altinntjenestercontainerregistry.azurecr.io/configs/kuberneteswrapper-${ENVIRONMENT}
  provider: azure
---
apiVersion: kustomize.toolkit.fluxcd.io/v1
kind: Kustomization
metadata:
  name: kuberneteswrapper
  namespace: default
spec:
  interval: 5m
  targetNamespace: default
  sourceRef:
    kind: OCIRepository
    name: kuberneteswrapper
    namespace: default
  path: ./
  prune: true
  timeout: 1m
---
apiVersion: notification.toolkit.fluxcd.io/v1beta3
kind: Alert
metadata:
  name: grafana-annotation-kuberneteswrapper
  namespace: default
spec:
  eventMetadata:
    env: ${ENVIRONMENT}
    cluster: studio-${ENVIRONMENT}-aks
    app: kuberneteswrapper
  eventSeverity: info
  eventSources:
    - kind: HelmRelease
      name: kuberneteswrapper
  providerRef:
    name: grafana
