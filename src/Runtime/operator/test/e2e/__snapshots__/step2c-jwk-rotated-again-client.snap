
[controller Operator should handle second JWK rotation and trim to 2 keys - 1]
{
 "apiVersion": "resources.altinn.studio/v1alpha1",
 "kind": "MaskinportenClient",
 "metadata": {
  "creationTimestamp": "2024-01-01T00:00:00Z",
  "finalizers": [
   "altinn.studio/maskinporten-finalizer"
  ],
  "generation": 2,
  "labels": {
   "app": "ttd-localtestapp-deployment"
  },
  "name": "ttd-localtestapp",
  "namespace": "default",
  "resourceVersion": "<sanitized-resource-version>",
  "uid": "<sanitized-uid>"
 },
 "spec": {
  "scopes": [
   "altinn:serviceowner/instances.read"
  ]
 },
 "status": {
  "actionHistory": [
   {
    "command": "AddFinalizerCommand",
    "result": "added",
    "timestamp": "2024-01-01T00:00:00Z",
    "traceId": "<sanitized-trace-id>"
   },
   {
    "command": "CreateClientInApiCommand",
    "details": "clientId: <sanitized-client-id>, scopes: 2",
    "result": "created",
    "timestamp": "2024-01-01T00:00:00Z",
    "traceId": "<sanitized-trace-id>"
   },
   {
    "command": "UpdateSecretContentCommand",
    "details": "keys: 1",
    "result": "synced",
    "timestamp": "2024-01-01T00:00:00Z",
    "traceId": "<sanitized-trace-id>"
   },
   {
    "command": "UpdateClientInApiCommand",
    "details": "scopes: 1, jwks: false",
    "result": "updated",
    "timestamp": "2024-01-01T00:00:00Z",
    "traceId": "<sanitized-trace-id>"
   },
   {
    "command": "UpdateClientInApiCommand",
    "details": "scopes: 0, jwks: true",
    "result": "updated",
    "timestamp": "2024-01-01T00:00:00Z",
    "traceId": "<sanitized-trace-id>"
   },
   {
    "command": "UpdateSecretContentCommand",
    "details": "keys: 2",
    "result": "synced",
    "timestamp": "2024-01-01T00:00:00Z",
    "traceId": "<sanitized-trace-id>"
   },
   {
    "command": "RemoveRotateAnnotationCommand",
    "result": "removed",
    "timestamp": "2024-01-01T00:00:00Z",
    "traceId": "<sanitized-trace-id>"
   },
   {
    "command": "UpdateClientInApiCommand",
    "details": "scopes: 0, jwks: true",
    "result": "updated",
    "timestamp": "2024-01-01T00:00:00Z",
    "traceId": "<sanitized-trace-id>"
   },
   {
    "command": "UpdateSecretContentCommand",
    "details": "keys: 2",
    "result": "synced",
    "timestamp": "2024-01-01T00:00:00Z",
    "traceId": "<sanitized-trace-id>"
   },
   {
    "command": "RemoveRotateAnnotationCommand",
    "result": "removed",
    "timestamp": "2024-01-01T00:00:00Z",
    "traceId": "<sanitized-trace-id>"
   }
  ],
  "authority": "http://fakes:8050/",
  "clientId": "<sanitized-client-id>",
  "conditions": [
   {
    "lastTransitionTime": "2024-01-01T00:00:00Z",
    "message": "Client updated: <sanitized-client-id>",
    "observedGeneration": 2,
    "reason": "Updated",
    "status": "True",
    "type": "ClientRegistered"
   },
   {
    "lastTransitionTime": "2024-01-01T00:00:00Z",
    "message": "Secret updated with 2 keys",
    "observedGeneration": 2,
    "reason": "Updated",
    "status": "True",
    "type": "SecretSynced"
   },
   {
    "lastTransitionTime": "2024-01-01T00:00:00Z",
    "message": "Reconciled 3 resources",
    "observedGeneration": 2,
    "reason": "Reconciled",
    "status": "True",
    "type": "Ready"
   }
  ],
  "keyIds": [
   "<key-uuid>.2",
   "<key-uuid>.1"
  ],
  "lastSynced": "2024-01-01T00:00:00Z",
  "observedGeneration": 2
 }
}
---
