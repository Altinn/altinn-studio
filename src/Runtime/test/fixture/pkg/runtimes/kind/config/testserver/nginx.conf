events {
    worker_connections 256;
}
http {
    include /etc/nginx/mime.types;
    default_type application/octet-stream;

    server {
        listen 80;

        location /app/api/setcookie {
            default_type application/json;
            add_header Set-Cookie "isolation_test_same=value; Path=/" always;
            add_header Content-Type application/json;
            return 200 '{"status":"ok","cookie":"isolation_test_same"}';
        }

        location /app/api/setparentcookie {
            default_type application/json;
            add_header Set-Cookie "isolation_test_parent=value; Path=/; Domain=.default.svc.cluster.local" always;
            add_header Content-Type application/json;
            return 200 '{"status":"ok","cookie":"isolation_test_parent"}';
        }

        location /app/api/ {
            default_type application/json;
            return 200 '{"status":"ok","timestamp":"$time_iso8601","path":"$uri"}';
            add_header Content-Type application/json;
        }

        location /app/tad/eur1/ {
            alias /usr/share/nginx/html/;
            index eur1.html;
        }

        location /app/ {
            alias /usr/share/nginx/html/;
            index index.html;
        }
    }
}
