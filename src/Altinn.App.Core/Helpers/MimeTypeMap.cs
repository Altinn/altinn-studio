using System.Collections.Frozen;
using Altinn.App.Core.Models;

namespace Altinn.App.Core.Helpers;

/// <summary>
/// MimeTypeMap based on https://github.com/samuelneff/MimeTypeMap
/// </summary>
public static class MimeTypeMap
{
    private static readonly Lazy<FrozenDictionary<string, MimeType>> _mappings = new Lazy<
        FrozenDictionary<string, MimeType>
    >(BuildMappings);

    private static FrozenDictionary<string, MimeType> BuildMappings()
    {
        var mappings = new Dictionary<string, MimeType>(StringComparer.OrdinalIgnoreCase)
        {
            #region Big freaking list of mime types

            { ".323", new("text/h323") },
            { ".3g2", new("video/3gpp2") },
            { ".3gp", new("video/3gpp", "audio/3gpp") },
            { ".3gp2", new("video/3gpp2") },
            { ".3gpp", new("video/3gpp") },
            { ".7z", new("application/x-7z-compressed") },
            { ".aa", new("audio/audible") },
            { ".AAC", new("audio/aac") },
            { ".aaf", new("application/octet-stream") },
            { ".aax", new("audio/vnd.audible.aax") },
            { ".ac3", new("audio/ac3") },
            { ".aca", new("application/octet-stream") },
            { ".accda", new("application/msaccess.addin") },
            { ".accdb", new("application/msaccess") },
            { ".accdc", new("application/msaccess.cab") },
            { ".accde", new("application/msaccess") },
            { ".accdr", new("application/msaccess.runtime") },
            { ".accdt", new("application/msaccess") },
            { ".accdw", new("application/msaccess.webapplication") },
            { ".accft", new("application/msaccess.ftemplate") },
            { ".acx", new("application/internet-property-stream") },
            { ".AddIn", new("text/xml") },
            { ".ade", new("application/msaccess") },
            { ".adobebridge", new("application/x-bridge-url") },
            { ".adp", new("application/msaccess") },
            { ".ADT", new("audio/vnd.dlna.adts") },
            { ".ADTS", new("audio/aac") },
            { ".afm", new("application/octet-stream") },
            { ".ai", new("application/postscript") },
            { ".aif", new("audio/aiff") },
            { ".aifc", new("audio/aiff") },
            { ".aiff", new("audio/aiff") },
            { ".air", new("application/vnd.adobe.air-application-installer-package+zip") },
            { ".amc", new("application/mpeg") },
            { ".anx", new("application/annodex") },
            { ".apk", new("application/vnd.android.package-archive") },
            { ".application", new("application/x-ms-application") },
            { ".art", new("image/x-jg") },
            { ".asa", new("application/xml") },
            { ".asax", new("application/xml") },
            { ".ascx", new("application/xml") },
            { ".asd", new("application/octet-stream") },
            { ".asf", new("video/x-ms-asf") },
            { ".ashx", new("application/xml") },
            { ".asi", new("application/octet-stream") },
            { ".asm", new("text/plain") },
            { ".asmx", new("application/xml") },
            { ".aspx", new("application/xml") },
            { ".asr", new("video/x-ms-asf") },
            { ".asx", new("video/x-ms-asf") },
            { ".atom", new("application/atom+xml") },
            { ".au", new("audio/basic") },
            { ".avi", new("video/x-msvideo") },
            { ".axa", new("audio/annodex") },
            { ".axs", new("application/olescript") },
            { ".axv", new("video/annodex") },
            { ".bas", new("text/plain") },
            { ".bcpio", new("application/x-bcpio") },
            { ".bin", new("application/octet-stream") },
            { ".bmp", new("image/bmp") },
            { ".c", new("text/plain") },
            { ".cab", new("application/octet-stream") },
            { ".caf", new("audio/x-caf") },
            { ".calx", new("application/vnd.ms-office.calx") },
            { ".cat", new("application/vnd.ms-pki.seccat") },
            { ".cc", new("text/plain") },
            { ".cd", new("text/plain") },
            { ".cdda", new("audio/aiff") },
            { ".cdf", new("application/x-cdf") },
            { ".cer", new("application/x-x509-ca-cert") },
            { ".cfg", new("text/plain") },
            { ".chm", new("application/octet-stream") },
            { ".class", new("application/x-java-applet") },
            { ".clp", new("application/x-msclip") },
            { ".cmd", new("text/plain") },
            { ".cmx", new("image/x-cmx") },
            { ".cnf", new("text/plain") },
            { ".cod", new("image/cis-cod") },
            { ".config", new("application/xml") },
            { ".contact", new("text/x-ms-contact") },
            { ".coverage", new("application/xml") },
            { ".cpio", new("application/x-cpio") },
            { ".cpp", new("text/plain") },
            { ".crd", new("application/x-mscardfile") },
            { ".crl", new("application/pkix-crl") },
            { ".crt", new("application/x-x509-ca-cert") },
            { ".cs", new("text/plain") },
            { ".csdproj", new("text/plain") },
            { ".csh", new("application/x-csh") },
            { ".csproj", new("text/plain") },
            { ".css", new("text/css") },
            { ".csv", new("text/csv") },
            { ".cur", new("application/octet-stream") },
            { ".cxx", new("text/plain") },
            { ".dat", new("application/octet-stream") },
            { ".datasource", new("application/xml") },
            { ".dbproj", new("text/plain") },
            { ".dcr", new("application/x-director") },
            { ".def", new("text/plain") },
            { ".deploy", new("application/octet-stream") },
            { ".der", new("application/x-x509-ca-cert") },
            { ".dgml", new("application/xml") },
            { ".dib", new("image/bmp") },
            { ".dif", new("video/x-dv") },
            { ".dir", new("application/x-director") },
            { ".disco", new("text/xml") },
            { ".divx", new("video/divx") },
            { ".dll", new("application/x-msdownload") },
            { ".dll.config", new("text/xml") },
            { ".dlm", new("text/dlm") },
            { ".doc", new("application/msword") },
            { ".docm", new("application/vnd.ms-word.document.macroEnabled.12") },
            { ".docx", new("application/vnd.openxmlformats-officedocument.wordprocessingml.document") },
            { ".dot", new("application/msword") },
            { ".dotm", new("application/vnd.ms-word.template.macroEnabled.12") },
            { ".dotx", new("application/vnd.openxmlformats-officedocument.wordprocessingml.template") },
            { ".dsp", new("application/octet-stream") },
            { ".dsw", new("text/plain") },
            { ".dtd", new("text/xml") },
            { ".dtsConfig", new("text/xml") },
            { ".dv", new("video/x-dv") },
            { ".dvi", new("application/x-dvi") },
            { ".dwf", new("drawing/x-dwf") },
            { ".dwp", new("application/octet-stream") },
            { ".dxr", new("application/x-director") },
            { ".eml", new("message/rfc822") },
            { ".emz", new("application/octet-stream") },
            { ".eot", new("application/vnd.ms-fontobject") },
            { ".eps", new("application/postscript") },
            { ".etl", new("application/etl") },
            { ".etx", new("text/x-setext") },
            { ".evy", new("application/envoy") },
            { ".exe", new("application/octet-stream") },
            { ".exe.config", new("text/xml") },
            { ".fdf", new("application/vnd.fdf") },
            { ".fif", new("application/fractals") },
            { ".filters", new("application/xml") },
            { ".fla", new("application/octet-stream") },
            { ".flac", new("audio/flac") },
            { ".flr", new("x-world/x-vrml") },
            { ".flv", new("video/x-flv") },
            { ".fsscript", new("application/fsharp-script") },
            { ".fsx", new("application/fsharp-script") },
            { ".generictest", new("application/xml") },
            { ".gif", new("image/gif") },
            { ".gml", new("application/gml+xml") },
            { ".gpx", new("application/gpx+xml") },
            { ".group", new("text/x-ms-group") },
            { ".gsm", new("audio/x-gsm") },
            { ".gtar", new("application/x-gtar") },
            { ".gz", new("application/x-gzip") },
            { ".h", new("text/plain") },
            { ".hdf", new("application/x-hdf") },
            { ".hdml", new("text/x-hdml") },
            { ".hhc", new("application/x-oleobject") },
            { ".hhk", new("application/octet-stream") },
            { ".hhp", new("application/octet-stream") },
            { ".hlp", new("application/winhlp") },
            { ".hpp", new("text/plain") },
            { ".hqx", new("application/mac-binhex40") },
            { ".hta", new("application/hta") },
            { ".htc", new("text/x-component") },
            { ".htm", new("text/html") },
            { ".html", new("text/html") },
            { ".htt", new("text/webviewhtml") },
            { ".hxa", new("application/xml") },
            { ".hxc", new("application/xml") },
            { ".hxd", new("application/octet-stream") },
            { ".hxe", new("application/xml") },
            { ".hxf", new("application/xml") },
            { ".hxh", new("application/octet-stream") },
            { ".hxi", new("application/octet-stream") },
            { ".hxk", new("application/xml") },
            { ".hxq", new("application/octet-stream") },
            { ".hxr", new("application/octet-stream") },
            { ".hxs", new("application/octet-stream") },
            { ".hxt", new("text/html") },
            { ".hxv", new("application/xml") },
            { ".hxw", new("application/octet-stream") },
            { ".hxx", new("text/plain") },
            { ".i", new("text/plain") },
            { ".ico", new("image/x-icon") },
            { ".ics", new("application/octet-stream") },
            { ".idl", new("text/plain") },
            { ".ief", new("image/ief") },
            { ".iii", new("application/x-iphone") },
            { ".inc", new("text/plain") },
            { ".inf", new("application/octet-stream") },
            { ".ini", new("text/plain") },
            { ".inl", new("text/plain") },
            { ".ins", new("application/x-internet-signup") },
            { ".ipa", new("application/x-itunes-ipa") },
            { ".ipg", new("application/x-itunes-ipg") },
            { ".ipproj", new("text/plain") },
            { ".ipsw", new("application/x-itunes-ipsw") },
            { ".iqy", new("text/x-ms-iqy") },
            { ".isp", new("application/x-internet-signup") },
            { ".ite", new("application/x-itunes-ite") },
            { ".itlp", new("application/x-itunes-itlp") },
            { ".itms", new("application/x-itunes-itms") },
            { ".itpc", new("application/x-itunes-itpc") },
            { ".IVF", new("video/x-ivf") },
            { ".jar", new("application/java-archive") },
            { ".java", new("application/octet-stream") },
            { ".jck", new("application/liquidmotion") },
            { ".jcz", new("application/liquidmotion") },
            { ".jfif", new("image/pjpeg") },
            { ".jnlp", new("application/x-java-jnlp-file") },
            { ".jpb", new("application/octet-stream") },
            { ".jpe", new("image/jpeg") },
            { ".jpeg", new("image/jpeg") },
            { ".jpg", new("image/jpeg") },
            { ".js", new("application/javascript") },
            { ".json", new("application/json") },
            { ".jsx", new("text/jscript") },
            { ".jsxbin", new("text/plain") },
            { ".latex", new("application/x-latex") },
            { ".library-ms", new("application/windows-library+xml") },
            { ".lit", new("application/x-ms-reader") },
            { ".loadtest", new("application/xml") },
            { ".lpk", new("application/octet-stream") },
            { ".lsf", new("video/x-la-asf") },
            { ".lst", new("text/plain") },
            { ".lsx", new("video/x-la-asf") },
            { ".lzh", new("application/octet-stream") },
            { ".m13", new("application/x-msmediaview") },
            { ".m14", new("application/x-msmediaview") },
            { ".m1v", new("video/mpeg") },
            { ".m2t", new("video/vnd.dlna.mpeg-tts") },
            { ".m2ts", new("video/vnd.dlna.mpeg-tts") },
            { ".m2v", new("video/mpeg") },
            { ".m3u", new("audio/x-mpegurl") },
            { ".m3u8", new("audio/x-mpegurl") },
            { ".m4a", new("audio/m4a", "audio/x-m4a") },
            { ".m4b", new("audio/m4b") },
            { ".m4p", new("audio/m4p") },
            { ".m4r", new("audio/x-m4r") },
            { ".m4v", new("video/x-m4v") },
            { ".mac", new("image/x-macpaint") },
            { ".mak", new("text/plain") },
            { ".man", new("application/x-troff-man") },
            { ".manifest", new("application/x-ms-manifest") },
            { ".map", new("text/plain") },
            { ".master", new("application/xml") },
            { ".mda", new("application/msaccess") },
            { ".mdb", new("application/x-msaccess") },
            { ".mde", new("application/msaccess") },
            { ".mdp", new("application/octet-stream") },
            { ".me", new("application/x-troff-me") },
            { ".mfp", new("application/x-shockwave-flash") },
            { ".mht", new("message/rfc822") },
            { ".mhtml", new("message/rfc822") },
            { ".mid", new("audio/mid") },
            { ".midi", new("audio/mid") },
            { ".mix", new("application/octet-stream") },
            { ".mk", new("text/plain") },
            { ".mmf", new("application/x-smaf") },
            { ".mno", new("text/xml") },
            { ".mny", new("application/x-msmoney") },
            { ".mod", new("video/mpeg") },
            { ".mov", new("video/quicktime") },
            { ".movie", new("video/x-sgi-movie") },
            { ".mp2", new("video/mpeg") },
            { ".mp2v", new("video/mpeg") },
            { ".mp3", new("audio/mpeg") },
            { ".mp4", new("video/mp4") },
            { ".mp4v", new("video/mp4") },
            { ".mpa", new("video/mpeg") },
            { ".mpe", new("video/mpeg") },
            { ".mpeg", new("video/mpeg") },
            { ".mpf", new("application/vnd.ms-mediapackage") },
            { ".mpg", new("video/mpeg") },
            { ".mpp", new("application/vnd.ms-project") },
            { ".mpv2", new("video/mpeg") },
            { ".mqv", new("video/quicktime") },
            { ".ms", new("application/x-troff-ms") },
            { ".msi", new("application/octet-stream") },
            { ".mso", new("application/octet-stream") },
            { ".mts", new("video/vnd.dlna.mpeg-tts") },
            { ".mtx", new("application/xml") },
            { ".mvb", new("application/x-msmediaview") },
            { ".mvc", new("application/x-miva-compiled") },
            { ".mxp", new("application/x-mmxp") },
            { ".nc", new("application/x-netcdf") },
            { ".nsc", new("video/x-ms-asf") },
            { ".nws", new("message/rfc822") },
            { ".ocx", new("application/octet-stream") },
            { ".oda", new("application/oda") },
            { ".odb", new("application/vnd.oasis.opendocument.database") },
            { ".odc", new("application/vnd.oasis.opendocument.chart") },
            { ".odf", new("application/vnd.oasis.opendocument.formula") },
            { ".odg", new("application/vnd.oasis.opendocument.graphics") },
            { ".odh", new("text/plain") },
            { ".odi", new("application/vnd.oasis.opendocument.image") },
            { ".odl", new("text/plain") },
            { ".odm", new("application/vnd.oasis.opendocument.text-master") },
            { ".odp", new("application/vnd.oasis.opendocument.presentation") },
            { ".ods", new("application/vnd.oasis.opendocument.spreadsheet") },
            { ".odt", new("application/vnd.oasis.opendocument.text") },
            { ".oga", new("audio/ogg") },
            { ".ogg", new("audio/ogg") },
            { ".ogv", new("video/ogg") },
            { ".ogx", new("application/ogg") },
            { ".one", new("application/onenote") },
            { ".onea", new("application/onenote") },
            { ".onepkg", new("application/onenote") },
            { ".onetmp", new("application/onenote") },
            { ".onetoc", new("application/onenote") },
            { ".onetoc2", new("application/onenote") },
            { ".opus", new("audio/ogg") },
            { ".orderedtest", new("application/xml") },
            { ".osdx", new("application/opensearchdescription+xml") },
            { ".otf", new("application/font-sfnt") },
            { ".otg", new("application/vnd.oasis.opendocument.graphics-template") },
            { ".oth", new("application/vnd.oasis.opendocument.text-web") },
            { ".otp", new("application/vnd.oasis.opendocument.presentation-template") },
            { ".ots", new("application/vnd.oasis.opendocument.spreadsheet-template") },
            { ".ott", new("application/vnd.oasis.opendocument.text-template") },
            { ".oxt", new("application/vnd.openofficeorg.extension") },
            { ".p10", new("application/pkcs10") },
            { ".p12", new("application/x-pkcs12") },
            { ".p7b", new("application/x-pkcs7-certificates") },
            { ".p7c", new("application/pkcs7-mime") },
            { ".p7m", new("application/pkcs7-mime") },
            { ".p7r", new("application/x-pkcs7-certreqresp") },
            { ".p7s", new("application/pkcs7-signature") },
            { ".pbm", new("image/x-portable-bitmap") },
            { ".pcast", new("application/x-podcast") },
            { ".pct", new("image/pict") },
            { ".pcx", new("application/octet-stream") },
            { ".pcz", new("application/octet-stream") },
            { ".pdf", new("application/pdf") },
            { ".pfb", new("application/octet-stream") },
            { ".pfm", new("application/octet-stream") },
            { ".pfx", new("application/x-pkcs12") },
            { ".pgm", new("image/x-portable-graymap") },
            { ".pic", new("image/pict") },
            { ".pict", new("image/pict") },
            { ".pkgdef", new("text/plain") },
            { ".pkgundef", new("text/plain") },
            { ".pko", new("application/vnd.ms-pki.pko") },
            { ".pls", new("audio/scpls") },
            { ".pma", new("application/x-perfmon") },
            { ".pmc", new("application/x-perfmon") },
            { ".pml", new("application/x-perfmon") },
            { ".pmr", new("application/x-perfmon") },
            { ".pmw", new("application/x-perfmon") },
            { ".png", new("image/png") },
            { ".pnm", new("image/x-portable-anymap") },
            { ".pnt", new("image/x-macpaint") },
            { ".pntg", new("image/x-macpaint") },
            { ".pnz", new("image/png") },
            { ".pot", new("application/vnd.ms-powerpoint") },
            { ".potm", new("application/vnd.ms-powerpoint.template.macroEnabled.12") },
            { ".potx", new("application/vnd.openxmlformats-officedocument.presentationml.template") },
            { ".ppa", new("application/vnd.ms-powerpoint") },
            { ".ppam", new("application/vnd.ms-powerpoint.addin.macroEnabled.12") },
            { ".ppm", new("image/x-portable-pixmap") },
            { ".pps", new("application/vnd.ms-powerpoint") },
            { ".ppsm", new("application/vnd.ms-powerpoint.slideshow.macroEnabled.12") },
            { ".ppsx", new("application/vnd.openxmlformats-officedocument.presentationml.slideshow") },
            { ".ppt", new("application/vnd.ms-powerpoint") },
            { ".pptm", new("application/vnd.ms-powerpoint.presentation.macroEnabled.12") },
            { ".pptx", new("application/vnd.openxmlformats-officedocument.presentationml.presentation") },
            { ".prf", new("application/pics-rules") },
            { ".prm", new("application/octet-stream") },
            { ".prx", new("application/octet-stream") },
            { ".ps", new("application/postscript") },
            { ".psc1", new("application/PowerShell") },
            { ".psd", new("application/octet-stream") },
            { ".psess", new("application/xml") },
            { ".psm", new("application/octet-stream") },
            { ".psp", new("application/octet-stream") },
            { ".pub", new("application/x-mspublisher") },
            { ".pwz", new("application/vnd.ms-powerpoint") },
            { ".qht", new("text/x-html-insertion") },
            { ".qhtm", new("text/x-html-insertion") },
            { ".qt", new("video/quicktime") },
            { ".qti", new("image/x-quicktime") },
            { ".qtif", new("image/x-quicktime") },
            { ".qtl", new("application/x-quicktimeplayer") },
            { ".qxd", new("application/octet-stream") },
            { ".ra", new("audio/x-pn-realaudio") },
            { ".ram", new("audio/x-pn-realaudio") },
            { ".rar", new("application/x-rar-compressed") },
            { ".ras", new("image/x-cmu-raster") },
            { ".rat", new("application/rat-file") },
            { ".rc", new("text/plain") },
            { ".rc2", new("text/plain") },
            { ".rct", new("text/plain") },
            { ".rdlc", new("application/xml") },
            { ".reg", new("text/plain") },
            { ".resx", new("application/xml") },
            { ".rf", new("image/vnd.rn-realflash") },
            { ".rgb", new("image/x-rgb") },
            { ".rgs", new("text/plain") },
            { ".rm", new("application/vnd.rn-realmedia") },
            { ".rmi", new("audio/mid") },
            { ".rmp", new("application/vnd.rn-rn_music_package") },
            { ".roff", new("application/x-troff") },
            { ".rpm", new("audio/x-pn-realaudio-plugin") },
            { ".rqy", new("text/x-ms-rqy") },
            { ".rtf", new("application/rtf") },
            { ".rtx", new("text/richtext") },
            { ".ruleset", new("application/xml") },
            { ".s", new("text/plain") },
            { ".safariextz", new("application/x-safari-safariextz") },
            { ".scd", new("application/x-msschedule") },
            { ".scr", new("text/plain") },
            { ".sct", new("text/scriptlet") },
            { ".sd2", new("audio/x-sd2") },
            { ".sdp", new("application/sdp") },
            { ".sea", new("application/octet-stream") },
            { ".searchConnector-ms", new("application/windows-search-connector+xml") },
            { ".setpay", new("application/set-payment-initiation") },
            { ".setreg", new("application/set-registration-initiation") },
            { ".settings", new("application/xml") },
            { ".sgimb", new("application/x-sgimb") },
            { ".sgml", new("text/sgml") },
            { ".sh", new("application/x-sh") },
            { ".shar", new("application/x-shar") },
            { ".shtml", new("text/html") },
            { ".sit", new("application/x-stuffit") },
            { ".sitemap", new("application/xml") },
            { ".skin", new("application/xml") },
            { ".sldm", new("application/vnd.ms-powerpoint.slide.macroEnabled.12") },
            { ".sldx", new("application/vnd.openxmlformats-officedocument.presentationml.slide") },
            { ".slk", new("application/vnd.ms-excel") },
            { ".sln", new("text/plain") },
            { ".slupkg-ms", new("application/x-ms-license") },
            { ".smd", new("audio/x-smd") },
            { ".smi", new("application/octet-stream") },
            { ".smx", new("audio/x-smd") },
            { ".smz", new("audio/x-smd") },
            { ".snd", new("audio/basic") },
            { ".snippet", new("application/xml") },
            { ".snp", new("application/octet-stream") },
            { ".sol", new("text/plain") },
            { ".sor", new("text/plain") },
            { ".sos", new("text/vnd.sosi") },
            { ".spc", new("application/x-pkcs7-certificates") },
            { ".spl", new("application/futuresplash") },
            { ".spx", new("audio/ogg") },
            { ".src", new("application/x-wais-source") },
            { ".srf", new("text/plain") },
            { ".SSISDeploymentManifest", new("text/xml") },
            { ".ssm", new("application/streamingmedia") },
            { ".sst", new("application/vnd.ms-pki.certstore") },
            { ".stl", new("application/vnd.ms-pki.stl") },
            { ".sv4cpio", new("application/x-sv4cpio") },
            { ".sv4crc", new("application/x-sv4crc") },
            { ".svc", new("application/xml") },
            { ".svg", new("image/svg+xml") },
            { ".swf", new("application/x-shockwave-flash") },
            { ".step", new("application/step") },
            { ".stp", new("application/step") },
            { ".t", new("application/x-troff") },
            { ".tar", new("application/x-tar") },
            { ".tcl", new("application/x-tcl") },
            { ".testrunconfig", new("application/xml") },
            { ".testsettings", new("application/xml") },
            { ".tex", new("application/x-tex") },
            { ".texi", new("application/x-texinfo") },
            { ".texinfo", new("application/x-texinfo") },
            { ".tgz", new("application/x-compressed") },
            { ".thmx", new("application/vnd.ms-officetheme") },
            { ".thn", new("application/octet-stream") },
            { ".tif", new("image/tiff") },
            { ".tiff", new("image/tiff") },
            { ".tlh", new("text/plain") },
            { ".tli", new("text/plain") },
            { ".toc", new("application/octet-stream") },
            { ".tr", new("application/x-troff") },
            { ".trm", new("application/x-msterminal") },
            { ".trx", new("application/xml") },
            { ".ts", new("video/vnd.dlna.mpeg-tts") },
            { ".tsv", new("text/tab-separated-values") },
            { ".ttf", new("application/font-sfnt") },
            { ".tts", new("video/vnd.dlna.mpeg-tts") },
            { ".txt", new("text/plain") },
            { ".u32", new("application/octet-stream") },
            { ".uls", new("text/iuls") },
            { ".user", new("text/plain") },
            { ".ustar", new("application/x-ustar") },
            { ".vb", new("text/plain") },
            { ".vbdproj", new("text/plain") },
            { ".vbk", new("video/mpeg") },
            { ".vbproj", new("text/plain") },
            { ".vbs", new("text/vbscript") },
            { ".vcf", new("text/x-vcard") },
            { ".vcproj", new("application/xml") },
            { ".vcs", new("text/plain") },
            { ".vcxproj", new("application/xml") },
            { ".vddproj", new("text/plain") },
            { ".vdp", new("text/plain") },
            { ".vdproj", new("text/plain") },
            { ".vdx", new("application/vnd.ms-visio.viewer") },
            { ".vml", new("text/xml") },
            { ".vscontent", new("application/xml") },
            { ".vsct", new("text/xml") },
            { ".vsd", new("application/vnd.visio") },
            { ".vsi", new("application/ms-vsi") },
            { ".vsix", new("application/vsix") },
            { ".vsixlangpack", new("text/xml") },
            { ".vsixmanifest", new("text/xml") },
            { ".vsmdi", new("application/xml") },
            { ".vspscc", new("text/plain") },
            { ".vss", new("application/vnd.visio") },
            { ".vsscc", new("text/plain") },
            { ".vssettings", new("text/xml") },
            { ".vssscc", new("text/plain") },
            { ".vst", new("application/vnd.visio") },
            { ".vstemplate", new("text/xml") },
            { ".vsto", new("application/x-ms-vsto") },
            { ".vsw", new("application/vnd.visio") },
            { ".vsx", new("application/vnd.visio") },
            { ".vtx", new("application/vnd.visio") },
            { ".wav", new("audio/wav") },
            { ".wave", new("audio/wav") },
            { ".wax", new("audio/x-ms-wax") },
            { ".wbk", new("application/msword") },
            { ".wbmp", new("image/vnd.wap.wbmp") },
            { ".wcm", new("application/vnd.ms-works") },
            { ".wdb", new("application/vnd.ms-works") },
            { ".wdp", new("image/vnd.ms-photo") },
            { ".webarchive", new("application/x-safari-webarchive") },
            { ".webm", new("video/webm") },
            { ".webp", new("image/webp") }, /* https://en.wikipedia.org/wiki/WebP */
            { ".webtest", new("application/xml") },
            { ".wiq", new("application/xml") },
            { ".wiz", new("application/msword") },
            { ".wks", new("application/vnd.ms-works") },
            { ".WLMP", new("application/wlmoviemaker") },
            { ".wlpginstall", new("application/x-wlpg-detect") },
            { ".wlpginstall3", new("application/x-wlpg3-detect") },
            { ".wm", new("video/x-ms-wm") },
            { ".wma", new("audio/x-ms-wma") },
            { ".wmd", new("application/x-ms-wmd") },
            { ".wmf", new("application/x-msmetafile") },
            { ".wml", new("text/vnd.wap.wml") },
            { ".wmlc", new("application/vnd.wap.wmlc") },
            { ".wmls", new("text/vnd.wap.wmlscript") },
            { ".wmlsc", new("application/vnd.wap.wmlscriptc") },
            { ".wmp", new("video/x-ms-wmp") },
            { ".wmv", new("video/x-ms-wmv") },
            { ".wmx", new("video/x-ms-wmx") },
            { ".wmz", new("application/x-ms-wmz") },
            { ".woff", new("application/font-woff") },
            { ".wpl", new("application/vnd.ms-wpl") },
            { ".wps", new("application/vnd.ms-works") },
            { ".wri", new("application/x-mswrite") },
            { ".wrl", new("x-world/x-vrml") },
            { ".wrz", new("x-world/x-vrml") },
            { ".wsc", new("text/scriptlet") },
            { ".wsdl", new("text/xml") },
            { ".wvx", new("video/x-ms-wvx") },
            { ".x", new("application/directx") },
            { ".xaf", new("x-world/x-vrml") },
            { ".xaml", new("application/xaml+xml") },
            { ".xap", new("application/x-silverlight-app") },
            { ".xbap", new("application/x-ms-xbap") },
            { ".xbm", new("image/x-xbitmap") },
            { ".xdr", new("text/plain") },
            { ".xht", new("application/xhtml+xml") },
            { ".xhtml", new("application/xhtml+xml") },
            { ".xla", new("application/vnd.ms-excel") },
            { ".xlam", new("application/vnd.ms-excel.addin.macroEnabled.12") },
            { ".xlc", new("application/vnd.ms-excel") },
            { ".xld", new("application/vnd.ms-excel") },
            { ".xlk", new("application/vnd.ms-excel") },
            { ".xll", new("application/vnd.ms-excel") },
            { ".xlm", new("application/vnd.ms-excel") },
            { ".xls", new("application/vnd.ms-excel") },
            { ".xlsb", new("application/vnd.ms-excel.sheet.binary.macroEnabled.12") },
            { ".xlsm", new("application/vnd.ms-excel.sheet.macroEnabled.12") },
            { ".xlsx", new("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet") },
            { ".xlt", new("application/vnd.ms-excel") },
            { ".xltm", new("application/vnd.ms-excel.template.macroEnabled.12") },
            { ".xltx", new("application/vnd.openxmlformats-officedocument.spreadsheetml.template") },
            { ".xlw", new("application/vnd.ms-excel") },
            { ".xml", new("application/xml", "text/xml") },
            { ".xmta", new("application/xml") },
            { ".xof", new("x-world/x-vrml") },
            { ".XOML", new("text/plain") },
            { ".xpm", new("image/x-xpixmap") },
            { ".xps", new("application/vnd.ms-xpsdocument") },
            { ".xrm-ms", new("text/xml") },
            { ".xsc", new("application/xml") },
            { ".xsd", new("text/xml") },
            { ".xsf", new("text/xml") },
            { ".xsl", new("text/xml") },
            { ".xslt", new("text/xml") },
            { ".xsn", new("application/octet-stream") },
            { ".xss", new("application/xml") },
            { ".xspf", new("application/xspf+xml") },
            { ".xtp", new("application/octet-stream") },
            { ".xwd", new("image/x-xwindowdump") },
            { ".z", new("application/x-compress") },
            { ".zip", new("application/zip", "application/x-zip-compressed", "application/zip-compressed") }

            #endregion
        };

        return mappings.ToFrozenDictionary(StringComparer.OrdinalIgnoreCase);
    }

    /// <summary>
    /// Get mime type for the given file extension
    /// </summary>
    /// <param name="extension">the file extension</param>
    /// <returns>The mime type</returns>
    public static MimeType GetMimeType(string extension)
    {
        ArgumentNullException.ThrowIfNull(extension);

        if (!extension.StartsWith('.'))
        {
            extension = "." + extension;
        }

        return _mappings.Value.TryGetValue(extension, out MimeType? mime)
            ? mime
            : new MimeType("application/octet-stream");
    }
}
